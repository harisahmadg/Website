```
   protected Set<ResourceRecord> processResponse(ByteBuffer responseBuffer) {

    	byte[] respBufArray = responseBuffer.array().clone(); 
    	short ID; // 1st header (2 bytes)
    	int QR = 0, Opcode = 0, AA = 0, TC = 0, RD = 0, RA = 0, Z = 0, RCODE = 0; // 2nd header (total 2 bytes)
    	int QDCOUNT, ANCOUNT, NSCOUNT, ARCOUNT; // 3,4,5,6th headers (each 2 bytes, total 8 bytes)
    	Set<ResourceRecord> nameServerResourceRecords = new HashSet<ResourceRecord>();
    	
    	ID = responseBuffer.getShort();
    	
    	// 2nd header:
    	short secondHeader = responseBuffer.getShort();
    	String sHBin = Integer.toBinaryString(0xFFFF & secondHeader); 
    	
    	// set 2nd header vars
    	QR = Integer.parseInt(Character.toString(sHBin.charAt(0)));
    	Opcode = Integer.parseInt(sHBin.substring(1, 5), 2);
    	AA = Integer.parseInt(Character.toString(sHBin.charAt(5)));
    	TC = Integer.parseInt(Character.toString(sHBin.charAt(6)));
    	RD = Integer.parseInt(Character.toString(sHBin.charAt(7)));
    	RA = Integer.parseInt(Character.toString(sHBin.charAt(8)));
    	Z = Integer.parseInt(sHBin.substring(9, 12), 2); // ,2 converts from binary
    	RCODE = Integer.parseInt(sHBin.substring(12, 16), 2); // ,2 converts from binary
    	
    	
    	listener.receivedResponse(ID, AA == 1 ? true: false, RCODE);

    	QDCOUNT = Short.toUnsignedInt(responseBuffer.getShort());
    	ANCOUNT = Short.toUnsignedInt(responseBuffer.getShort());
    	NSCOUNT = Short.toUnsignedInt(responseBuffer.getShort());
    	ARCOUNT = Short.toUnsignedInt(responseBuffer.getShort());
    	    
    	
    	String QNAME = "";
    	int QTYPE = 0, QCLASS = 0;
    	
    	if (QDCOUNT == 1) {
    		// get qname
        	QNAME = byteArrayToLabel(respBufArray, responseBuffer.position());
        	
        	//reposition
        	responseBuffer.position(responseBuffer.position() + getNameLength(respBufArray, responseBuffer.position()));
        	
        	// get qtype, qclass (2 bytes each)
        	QTYPE = responseBuffer.getShort();
        	QCLASS = responseBuffer.getShort();
    	}
```